{{/*
  API Path Page Layout

  Shows all HTTP methods for a single API path using RapiDoc.
  Uses match-type="includes" to filter by path (not method).

  Required frontmatter:
  - title: The API path (e.g., "/api/v3/configure/token/admin")
  - specFile: Path to the path-specific OpenAPI spec
  - apiPath: The API path for RapiDoc filtering
  - operations: Array of operations with method, operationId, summary

  Optional frontmatter:
  - tag: Associated OpenAPI tag name
  - related: Array of related documentation paths
*/}}

{{ partial "header.html" . }}
{{ partial "topnav.html" . }}

<div class="page-wrapper">
  {{ partial "sidebar.html" . }}

  <div class="content-wrapper api-content">
    <div class="api-main">
      <article class="article article--content api-reference api-path-page" role="main">
        <header class="article--header">
          <h1 class="article--title"><code>{{ .Params.apiPath }}</code></h1>
          {{ with .Description }}
          <p class="article--description">{{ . }}</p>
          {{ end }}
        </header>

        {{/* Download OpenAPI spec button */}}
        {{ with .Params.specFile }}
        <div class="api-spec-actions">
          <a href="{{ . }}" class="btn api-spec-download" download>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
              <path d="M8 12L3 7h3V2h4v5h3L8 12z"/>
              <path d="M1 14h14v2H1v-2z"/>
            </svg>
            Download OpenAPI Spec
          </a>
        </div>
        {{ end }}

        {{/* Hugo page content shown as overview */}}
        {{ with .Content }}
        <section class="api-content-overview">
          {{ . }}
        </section>
        {{ end }}

        {{/* RapiDoc renders all methods for this path */}}
        {{ with .Params.specFile }}
        <section class="api-renderer-section">
          {{ partial "api/rapidoc-path.html" $ }}
        </section>
        {{ end }}

        {{/* Related documentation links */}}
        {{ partial "article/related.html" . }}

      </article>
    </div>

    {{/* Right sidebar: Methods TOC */}}
    {{ $operations := .Params.operations }}
    {{ if $operations }}
    <aside class="api-toc" data-component="api-toc">
      <h4 class="api-toc-header">METHODS</h4>
      <nav class="api-toc-nav">
        {{ range $operations }}
        <a href="#{{ lower .method }}" class="api-toc-link">
          <span class="api-method api-method--{{ lower .method }}">{{ upper .method }}</span>
          <span class="api-toc-summary">{{ .summary }}</span>
        </a>
        {{ end }}
      </nav>
    </aside>
    {{ end }}
  </div>
</div>

{{ partial "footer.html" . }}
