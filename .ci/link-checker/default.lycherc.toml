# Lychee link checker configuration
# Updated for link-checker v1.3.1 with severity-based classification
#
# With severity levels, we no longer need to exclude sites that return:
# - 403/401/429 (classified as "info" - shown but don't fail CI)
# - 5xx/timeout (classified as "warning" - shown but don't fail CI)
# Only 404/410/DNS failures are classified as "error" and fail CI.

[lychee]
# Performance settings
max_retries = 3
timeout = 30
max_concurrency = 128
skip_code_blocks = false

# HTTP settings
user_agent = "Mozilla/5.0 (compatible; link-checker)"

# Accept these HTTP status codes as valid (2xx and redirects)
accept = [200, 201, 202, 203, 204, 206, 301, 302, 303, 304, 307, 308]

# Skip these URL schemes
scheme = ["file", "mailto", "tel"]

# Exclude patterns (regex supported)
# NOTE: With v1.3.0 severity classification, we only need to exclude:
# - Non-HTTP URLs (localhost, local networks)
# - Placeholder/example URLs
# - Known false positives (not HTTP status related)
exclude = [
  # Localhost and local network URLs
  "^https?://localhost",
  "^https?://127\\.0\\.0\\.1",
  "^https?://.*\\.local",

  # Example domains used in documentation
  "^https?://example\\.(com|org|net)",

  # Placeholder URLs from code block filtering
  "https://example.com/REMOVED_FROM_CODE_BLOCK",
  "example.com/INLINE_CODE_URL",

  # Common documentation placeholders
  "YOUR_.*",
  "REPLACE_.*",
  "<.*>",
]

# Request headers
[headers]
# Add custom headers here if needed

# Cache settings
cache = true
max_cache_age = "1d"

# Severity classification (link-checker v1.3.0+)
# These settings control which HTTP status codes fail CI vs show as warnings/info
[severity]
# Error codes fail CI - genuine broken links
error_codes = [404, 410]

# Warning codes are shown but don't fail CI - transient issues
warning_codes = [500, 502, 503, 504]

# Info codes are low priority - access restrictions, bot protection
info_codes = [401, 403, 429]

# Set to true to treat warnings as errors (stricter validation)
strict = false
