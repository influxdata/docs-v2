---
title: Create custom checks
seotitle: Custom checks
description: >
  Create custom checks with tasks and Flux.
menu:
  influxdb_2_0:
    parent: Monitor & alert
weight: 201
v2.0/tags: [checks, tasks, Flux]
---

A check in InfluxDB queries data and assigns a status with a _level based on specific conditions.
InfluxDB stores the output of a check in the statuses measurement in the _monitoring system bucket.
A check gets one of the following statuses (`_level`): `crit`, `info`, `warn`, or `ok`.
Check statuses are written to a status measurement in the _monitoring bucket.

In the UI, you can create two kinds of check: `Threshold Check` and `Deadman Check`.

Creating a custom check using a task allows you to include more complex logic and data processing in the alerts you create.
Custom checks are also easy to share.

### Example: Create a check to monitor another task for failure

Use a task to receive alerts when a task fails.

1. In the InfluxDB UI, select **Tasks** in the navigation menu on the left.

    {{< nav-icon "tasks" >}}

2. Click **{{< icon "plus" >}} Create Task**, and then select **New Task**.
3. In the **Name** field, enter a descriptive name, for example, **Alert on task failure**, and then enter how often to run the task in the **Every** field, for example, `10m`. For more detail, such as using cron syntax or including an offset, see [Task configuration options](/influxdb/v2.0/process-data/task-options/).
4. Enter the [example script below]().

The script above does the following:

- Import the [Flux HTTP package](/influxdb/v2.0/reference/flux/stdlib/http/).
- Query the `statuses` measurement in the `_monitoring` bucket to retrieve all statuses generated by your check.
- Set the time range to monitor; use the same interval that the task is scheduled to run. For example, `range (start: -task.every)`.
- Set the `_level` to alert on, for example, `crit`, `warn`, `info`, or `ok`.
- Use the `map()` function to evaluate the criteria to send an alert using `http.post()`.
- Specify your email service `url` (endpoint), include applicable request `headers`, and verify your request `data` format follows the format specified for your email service.


<!--
TODO Document these 4 things: 
	_check_id: "0000000000000001",
	_check_name: "Failed Tasks Check",
	_type: "custom",
	tags: {},
-->

`

Use a task to receive alerts when a task fails.

#### Example alert task script

```js
import "strings"
    import "regexp"
import "influxdata/influxdb/monitor"
import "influxdata/influxdb/v1"

option task = {name: "Failed Tasks Check", every: 1h, offset: 4m}

task_data = from(bucket: "_tasks")
	|> range(start: -1h, stop: now())
	|> filter(fn: (r) =>
		(r["_measurement"] == "runs"))
	|> filter(fn: (r) =>
		(r["_field"] == "logs"))
	|> map(fn: (r) => ({ r with name: strings.split(v: regexp.findString(r: /option task = \{([^\}]+)/, v: r._value), t: "\\\\\\\"")[1] }))
	|> drop(columns: ["_value", "_start", "_stop"])
	|> group(columns: ["name", "taskID", "status", "_measurement"])
	|> map(fn: (r) =>
		({r with _value: if r.status == "failed" then 1 else 0}))
	|> last()
check = {
	_check_id: "0000000000000001",
	_check_name: "Failed Tasks Check",
	_type: "custom",
	tags: {},
}
ok = (r) =>
	(r["logs"] == 0)
crit = (r) =>
	(r["logs"] == 1)
messageFn = (r) =>
	("The task: ${r.taskID} - ${r.name} has a status of ${r.status}")

task_data
	|> v1["fieldsAsCols"]()
	|> monitor["check"](
		data: check,
		messageFn: messageFn,
		ok: ok,
		crit: crit,
	)
```

## Add your task

Once your task is ready, see [Create a task](/influxdb/v2.0/process-data/manage-tasks/create-task) for information about adding it to InfluxDB.

{{% note %}}
This script does not send an email alert.
For information on how to create notification emails, see
[Create notification endpoints](/v2.0/monitor-alert/notification-endpoints/create)
and [Create notification rules](/v2.0/monitor-alert/notification-rules/create).
{{% /note %}}
